<html>
<head>
	<style type="text/css">
		html, body {
	  width:  100%;
	  height: 100%;
	  margin: 0px;
	}
	</style>
	<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
	<script>
	window.onload = function() {
		$.getJSON("geodesic_data.json", function(json) {

			var ctx = $("#canvas")[0].getContext("2d");
			
			// var ctx = c.getContext("2d");
			console.log("drawing cells");
			var dx = 400;
			var dy = 2000.5;
			var a = 9.0;
			$.each(json, function(i) {
				if (true || i % 10 == 0) {
				// console.log(i);
				var cell = json[i];
				var v = cell.vertices;
				if (Math.abs(v[0][0] - v[1][0]) > 10.0 ||
					Math.abs(v[1][0] - v[2][0]) > 10.0 ||
					Math.abs(v[2][0] - v[3][0]) > 10.0 ||
					Math.abs(v[3][0] - v[4][0]) > 10.0 ||
					Math.abs(v[4][0] - v[5][0]) > 10.0 ||
					Math.abs(v[5][0] - v[0][0]) > 10.0)
					return;
				ctx.moveTo(a*cell.vertices[0][0] + dx, -a*cell.vertices[0][1] + dy);
				ctx.lineTo(a*cell.vertices[1][0] + dx, -a*cell.vertices[1][1] + dy);
				ctx.moveTo(a*cell.vertices[1][0] + dx, -a*cell.vertices[1][1] + dy);
				ctx.lineTo(a*cell.vertices[2][0] + dx, -a*cell.vertices[2][1] + dy);
				ctx.moveTo(a*cell.vertices[2][0] + dx, -a*cell.vertices[2][1] + dy);
				ctx.lineTo(a*cell.vertices[3][0] + dx, -a*cell.vertices[3][1] + dy);
				ctx.moveTo(a*cell.vertices[3][0] + dx, -a*cell.vertices[3][1] + dy);
				ctx.lineTo(a*cell.vertices[4][0] + dx, -a*cell.vertices[4][1] + dy);
				ctx.moveTo(a*cell.vertices[4][0] + dx, -a*cell.vertices[4][1] + dy);
				ctx.lineTo(a*cell.vertices[5][0] + dx, -a*cell.vertices[5][1] + dy);
				ctx.moveTo(a*cell.vertices[5][0] + dx, -a*cell.vertices[5][1] + dy);
				ctx.lineTo(a*cell.vertices[0][0] + dx, -a*cell.vertices[0][1] + dy);

				}
			})
			ctx.stroke();
			$.each(json, function(i) {
				var cell = json[i];
				if (cell.hasOwnProperty('location_name')) {
					console.log(cell['location_name']);
					ctx.beginPath();
					ctx.arc(a*cell.center[0] + dx, -a*cell.center[1] + dy, 5, 0.0, 2.0*Math.PI, false);
					if (cell.atts.PCT_URBAN > 0.1)
						ctx.fillStyle = 'black';
					else
						ctx.fillStyle = 'lightgray';
					ctx.fill();
				} else if (cell.atts.PCT_LAKE > 5.0) {
					ctx.beginPath();
					ctx.arc(a*cell.center[0] + dx, -a*cell.center[1] + dy, 5, 0.0, 2.0*Math.PI, false);
					ctx.fillStyle = 'lightblue';
					ctx.fill();					
				}	else if (cell.atts.PCT_GLACIER > 0.0) {
					ctx.beginPath();
					ctx.arc(a*cell.center[0] + dx, -a*cell.center[1] + dy, 5, 0.0, 2.0*Math.PI, false);
					ctx.fillStyle = 'aqua';
					ctx.fill();										
				}	else if (cell.atts.SOIL_COLOR < 10.0) {
					ctx.beginPath();
					ctx.arc(a*cell.center[0] + dx, -a*cell.center[1] + dy, 5, 0.0, 2.0*Math.PI, false);
					ctx.fillStyle = 'burlywood';
					ctx.fill();
				}
			})
		});
	}
	</script>
</head>
<body>
	<canvas id="canvas" width="10000" height="10000" style="border:1px solid #d3d3d3;"></canvas>
</body>
</html>